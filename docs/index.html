<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>NAS Display</title>
  <link rel="stylesheet" href="MPPT.css">
</head>

<body>
  <h1>Arduino Based NAS Display</h1>


  <h3>Hardware Components</h3>
  - Arduino UNO<br>
  - LCD shield<br>
  - USB B to A cable<br>

  <img src="LCD_shield.png" alt="LCD_shield" height="250">

  <a href="https://wiki.dfrobot.com/LCD_KeyPad_Shield_For_Arduino_SKU__DFR0009">
    https://wiki.dfrobot.com/LCD_KeyPad_Shield_For_Arduino_SKU__DFR0009</a><br>
  <br>



  <h3>Arduino Installation</h3>

  Upload the NASDisplay.ino file to the Arduino.<br>
  The version on github works with a GPIO pin based LCD display (not the I2C version):
  <code>
    LiquidCrystal lcd(8, 9, 4, 5, 6, 7); // select the pins used on the LCD panel
  </code>



  <h3>Server Software Installation</h3>
  On server:<br>

  Download python script onto your server<br>
  <code>cd ~</code>
  <code>mkdir github</code>
  <code>cd github</code>
  <code>git clone https://github.com/atmelino/NASDisplay.git</code>
  <br>


  Install required python libraries<br>
  <code>sudo apt install python3-pip</code>
  <code>sudo apt install pipx</code>
  <code>pipx install pyserial</code>
  <code>sudo apt-get install lm-sensors</code>
  <code>pipx install PySensors</code>
  <br>
  Permission denied: '/dev/ttyACM0'<br>
  <code>sudo usermod -a -G dialout [your_username]</code> log out and
  log back in<br>
  actually, only worked after reboot<br>
  modemmanager causes problems by probing serial ports<br>
  remove modemmanager:<br>
  <br>
  <code>sudo apt-get purge modemmanager</code> <br>
  <a
    href="https://askubuntu.com/questions/216114/how-can-i-remove-modem-manager-from-boot">https://askubuntu.com/questions/216114/how-can-i-remove-modem-manager-from-boot</a><br>
  <br>
  <br>
  <h2> Run Service as root</h2>
  Since we want to be able to shut down the computer with a python
  script, we need to run the service as root.<br>
  <br>
  In the NASDisplay.service file, the lines will be<br>
  <br>
  <code>[Service]<br>
      User=root<br>
    </code>&nbsp;<br>
  The serial and sensor packages need to be installed such that they
  are available to root.<br>
  <br>
  <code>sudo su<br>
      cd ~<br>
      umask 022<br>
      pip install pyserial<br>
      pip install PySensors</code> <br>
  <a
    href="https://stackoverflow.com/questions/36898474/how-to-install-a-module-for-all-users-with-pip-on-linux">https://stackoverflow.com/questions/36898474/how-to-install-a-module-for-all-users-with-pip-on-linux</a><br>
  <br>
  <h2> Autostart Display script at Boot</h2>
  add the NASDisplay software as a service using systemd.<br>
  add file NASDisplay.service to /etc/systemd/system.<br>
  Start and stop:<br>
  <code>sudo systemctl start NASDisplay.service</code><br>
  <code>sudo systemctl stop NASDisplay.service</code><br>
  check status:<br>
  <code>sudo systemctl status NASDisplay.service</code><br>
  during development<br>
  <code>sudo systemctl daemon-reload</code><br>
  <code>sudo systemctl restart NASDisplay.service</code><br>
  To start automatically at boot:<br>
  <code>sudo systemctl enable NASDisplay.service</code><br>
  To list all services:<br>
  <code>sudo systemctl list-unit-files</code><br>
  or<br>
  <code>sudo systemctl list-unit-files | grep NASDisplay.service </code><br>
  To see output from service:<br>
  <code>journalctl -u NASDisplay.service -b</code><br>
  To shorten journal file:<br>
  <code>sudo journalctl --rotate</code><br>
  <code>sudo journalctl --vacuum-time=1s</code><br>
  <br>
</body>

</html>